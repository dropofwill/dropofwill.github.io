function SankeyHasMany(){"use strict";function t(t){e.width=e.width-e.margin.left-e.margin.right,e.height=e.height-e.margin.top-e.margin.bottom,t.each(function(t,r){var a=t;e.sankey=d3.sankey().nodeWidth(e.nodeWidth).nodePadding(e.nodePadding).size([e.width,e.height]).nodes(a.nodes).links(a.links).layout(e.forceIterations),e.path=e.sankey.link(),e.svg=d3.select(this),e.svg.attr({width:e.width+e.margin.left+e.margin.right,height:e.height+e.margin.top+e.margin.bottom}),e.links=e.svg.append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")").selectAll(".link").data(a.links).enter().append("path").attr("class","link").attr("d",e.path).style("stroke-width",function(t){return Math.max(1,t.dy)}).attr("stroke",function(t){return e.color(t.source.name)}).sort(function(t,n){return n.dy-t.dy}),e.nodes=e.svg.append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")").selectAll(".node").data(a.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.behavior.drag().origin(function(t){return t}).on("dragstart",function(){this.parentNode.appendChild(this)}).on("drag",n)),e.links.append("title").text(function(t){return t.source.name+" \u2192 "+t.target.name+"\nNo.: "+e.formatFloat(t.value)}),e.nodes.append("rect").attr("height",function(t){return t.dy}).attr("width",e.sankey.nodeWidth()).style("fill",function(t){return e.color(t.name.replace(/ .*/,""))}).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).append("title").text(function(t){return t.name+"\n"+e.formatFloat(t.value)}),e.nodes.append("text").attr("x",-6).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){return t.name}).filter(function(t){return t.x<e.width/2}).attr("x",6+e.sankey.nodeWidth()).attr("text-anchor","start")})}function n(t){d3.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(e.height-t.dy,d3.event.y)))+")"),e.sankey.relayout(),e.links.attr("d",e.path)}function r(n){function r(r){return arguments.length?(e[n]=r,t):e[n]}return r}var e={margin:{top:20,right:1,bottom:6,left:1},formatFloat:d3.format(",.0f"),color:d3.scale.ordinal().range(colorbrewer.Dark2[8]),nodeWidth:15,nodePadding:10,forceIterations:10,width:960,height:700,sankey:null,path:null,svg:null,links:null,nodes:null};for(var a in e)t[a]=r(a);return t}